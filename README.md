# Overview

Setup the different tools required for AWS pentesting

## Installation

### pre-installation

Install some dependancies:

`
sudo apt-get install python3-pip unzip gnupg software-properties-common curl -y
`

### install & run

* Clone the repo:

`
git clone https://github.com/danymello/vectra_aws_pentest.git
`

* Run the script:

```
 cd vectra_aws_pentest
./aws_pentest_lab.py --install
```

## Post-installation

* Enable AWS CLI auto-completion.

Add this to your bashrc file:

`
complete -C '/usr/local/bin/aws_completer' aws
`

Configure AWS profile for target AWS account

`


## Common issues

symptoms:

`
fguillot@ubuntu20:~/aws_pentest/aws$ aws
bash: /usr/local/bin/aws: Permission denied
`

Run:

`
sudo chmod +x /usr/local/bin/aws*
`

symptoms:

```
fguillot@ubuntu20:~$
fguillot@ubuntu20:~$ pyenv activate cloudgoat

Failed to activate virtualenv.

Perhaps pyenv-virtualenv has not been loaded into your shell properly.
Please restart current shell and try again.
```

Run:

```
echo 'eval "$(pyenv init -)"' >> ~/.bashrc
exec $SHELL
```

Then try to activate the virtual env again.

*SimpleS3Scanner:*

```
(SimpleS3Scanner) fguillot@ubuntu20:~/aws_pentest/SimpleS3Scanner$ python sss.py -h
Traceback (most recent call last):
  File "sss.py", line 4, in <module>
    from src.s3 import S3
  File "/home/fguillot/aws_pentest/SimpleS3Scanner/src/s3.py", line 4, in <module>
    import pandas as pd
ModuleNotFoundError: No module named 'pandas'
(SimpleS3Scanner) fguillot@ubuntu20:~/aws_pentest/SimpleS3Scanner$ python -m pip install requirements.txt
ERROR: Could not find a version that satisfies the requirement requirements.txt (from versions: none)
ERROR: No matching distribution found for requirements.txt
(SimpleS3Scanner) fguillot@ubuntu20:~/aws_pentest/SimpleS3Scanner$ python -m pip install -r requirements.txt
Collecting pandas==1.1.5
  Using cached pandas-1.1.5-cp38-cp38-manylinux1_x86_64.whl (9.3 MB)
```

## Known issues

* Cloudgoat is not compatible with multiple users setting up the scenario: iam_privesc_by_attachment
* For SimpleS3Scanner, pip to install requirements has to run twice.